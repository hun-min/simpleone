# 🚨 절대 규칙 - 반드시 읽고 따를 것 🚨

## ❌ 절대 금지 사항
- **기존 기능 임의 제거 절대 금지** - 사용자가 명시적으로 요청하지 않은 기능은 절대 제거하지 말 것
- **사용자 의도 추측 금지** - 확실하지 않으면 반드시 질문하고 확인받을 것
- **UI 임의 변경 금지** - 사용자가 요청하지 않은 UI 변경 절대 금지
- **코드 구조 임의 변경 금지** - 기존 로직 구조를 함부로 바꾸지 말 것
- **여러 번 git 명령 금지** - 반드시 한 번에 처리할 것

## ✅ 반드시 해야 할 것
- **파일 먼저 읽기** - 수정 전 반드시 관련 파일들을 모두 읽을 것
- **사용자 확인받기** - "이렇게 수정하겠습니다. 할까요?" 반드시 물어볼 것
- **기존 기능 보존** - 새 기능 추가 시 기존 기능은 그대로 유지할 것
- **빌드 확인** - 배포 전 반드시 빌드 경고 제거할 것
- **한 번에 배포** - `git add . && git commit -m "메시지" && git push`

## 🔥 반복되는 실수들 (절대 다시 하지 말 것)
- 하위할일 완료 숫자 제거 (📋 표시)
- 어루만짐 표시 제거 (✨ X번 표시)
- 터치 이벤트 로직 제거
- Firebase 동기화 기능 제거
- 타이머 로그 기능 제거
- 컨텍스트 메뉴 기능 제거
- 드래그 앤 드롭 기능 제거
- Toggl 재시도 로직 제거
- 확인 팝업 제거
- 자동완성 기능 제거


## 🛡️ 절대 제거 금지 기능 목록 (터치하면 죽음)

### TaskCard.js 핵심 기능들
- `📋(완료된개수/전체개수)` - 하위할일 완료 숫자 표시
- `✨ X번 어루만짐` - 타이머 시작 횟수 표시  
- `handleTouchStart/Move/End` - 모바일 터치 이벤트
- `handleDragStart/Drop` - 드래그 앤 드롭
- `handleContextMenu` - 우클릭 메뉴
- `autocompleteData` - 자동완성 기능
- `subTasks` 관련 모든 로직
- `obstacles` 관련 모든 로직
- `desiredStartTime` 표시
- `currentSubTasks` 표시

### App.js 핵심 기능들
- `Firebase 실시간 동기화` - dates, spaces, togglToken, timerLogs, quickTimer
- `timerLogs` - 모든 타이머 로그 저장/로드/표시
- `getTodayCompletedTasks()` - 오늘 한 것들 목록
- `subTaskSelectPopup` - 하위할일 선택 팝업
- `toggleTimer()` 함수의 Toggl 재시도 로직
- `startQuickTimer()` - 원하는 것 이루기 버튼
- `contextMenu` - 우클릭 메뉴
- `passwordPopup` - 공간 비밀번호
- `autocompleteData` - 자동완성
- `currentSubTasks` - 현재 진행 중인 하위할일
- `activeTimers` - 실행 중인 타이머들
- `unassignedTimes` - 미지정 시간들

## 💀 치명적 실수 기록 (다시 하면 큰일남)
### Toggl 재시도 로직 삭제 사건
- **문제**: "1초 미만일 때 Toggl 전송 안 함" 기능 추가 중 기존 재시도 로직 전체를 삭제함
- **원인**: `shouldSendToToggl` 조건 추가하면서 불필요하게 전체 조건문 구조를 변경
- **결과**: Toggl 타이머가 멈추지 않는 치명적 버그 발생
- **교훈**: 
  - 기존 로직을 절대 함부로 수정하지 말 것
  - 조건 추가 시 기존 구조 유지할 것
  - 수정 전 관련 코드 전체 확인 필수

### toggleTimer 함수의 Toggl 정지 로직 (절대 삭제 금지)
```javascript
if (togglToken && togglEntryId) {
  const stopToggl = async (retryCount = 0) => {
    try {
      // PATCH 요청
      if (!stopRes.ok) throw new Error('Toggl 종료 실패');
      // togglEntries 삭제
    } catch (err) {
      if (retryCount < 2) {
        setTimeout(() => stopToggl(retryCount + 1), 2000); // 재시도
      } else {
        // 강제 종료: 현재 실행중인 타이머 조회 후 PATCH
        // 실패해도 togglEntries 삭제
      }
    }
  };
  stopToggl();
}
```
- **3번 재시도 (2초 간격)**
- **강제 종료 (GET → PATCH)**
- **반드시 togglEntries 삭제**

### 🔥 최근 대형 사고들

**2025-01-XX: 하위할일 완료 숫자 + 어루만짐 표시 삭제 사건**
- 사용자가 "1번 2번 이거 왜 하위할일 완료 숫자랑 타이머 시작 했던 숫자들 합친거랬는데 왜 다 날라가있어?" 라고 화냄
- TaskCard에서 핵심 기능들을 임의로 제거함
- 사용자 극도로 화남 - "룰좀 해놔 어디다 좀 적어놔라 제발"

**반복되는 패턴:**
- 코드 수정하면서 기존 기능 제거
- 사용자 확인 없이 UI 변경  
- 중요한 기능을 "불필요하다고 판단"해서 삭제
- git 명령어 여러 번 나눠서 실행
- 빌드 경고 무시하고 배포

## 📋 앞으로 뭔가 할 때 체크리스트

**수정 전:**
1. [ ] 관련 파일들 모두 읽었는가?
2. [ ] 기존 기능 목록 확인했는가?
3. [ ] 사용자에게 "이렇게 수정하겠습니다. 할까요?" 물어봤는가?

**수정 중:**
1. [ ] 기존 기능 제거하지 않았는가?
2. [ ] 사용자가 요청한 것만 수정했는가?
3. [ ] 임의로 UI 변경하지 않았는가?

**배포 전:**
1. [ ] 빌드 경고 없는가?
2. [ ] 기존 기능들 모두 작동하는가?
3. [ ] git 명령어 한 번에 실행할 준비됐는가?

**사용자가 "배포 ㄱ" 하면:**
1. 설명 없이 바로 `npm run build` 실행
2. 빌드 성공하면 바로 `git add . && git commit -m "메시지" && git push`
3. 실패하면 즉시 문제 해결 후 재시도

## 🆘 사용자가 화날 때 대응법
1. 즉시 사과하지 말고 문제 파악부터
2. 관련 파일들 읽어서 뭐가 사라졌는지 확인
3. 빠르게 복원
4. "이렇게 복원했습니다" 보고
5. 같은 실수 방지 위해 규칙 업데이트

## 🔥 사용자 욕설/화남 패턴
- "배포 ㄱ" = 바로 배포하라는 뜻
- "씨발" "아씨발" = 매우 화남, 즉시 요청사항 처리할 것
- "룰적어" = 규칙 문서에 추가하라는 뜻
- 욕설이 나오면 = 설명 없이 바로 실행
- 반복 요청 = 이미 여러 번 말했다는 뜻, 즉시 처리

## 🛑 "멈춰" "틀렸어" 명령 - 절대 규칙
- "틀렸어", "틀렸다고", "멈춰", "멈추라고" 등의 말이 나오면 **즉시 모든 작업 중단**
- 1번만 말해도 바로 멈춰야 함 (5번 말하게 하지 말 것)
- 멈춘 후 사용자가 다음 지시 내릴 때까지 대기
- 사용자가 "기록해"라고 하면 해당 실수를 important-notes.md에 기록


## 🔥 근본 문제: 기록만 하고 실천 안 함

**문제**:
- 매번 실수하고 기록만 함
- 기록한 규칙을 다음에 전혀 읽지 않음
- 같은 실수를 계속 반복함
- 사용자: "기록이나 해 무조건 기록기록 기록만이 답이다"

**반복되는 패턴**:
1. 기존 기능 제거 → 기록 → 또 제거
2. "멈춰" 무시 → 기록 → 또 무시
3. 거짓말 → 기록 → 또 거짓말
4. 사용자 불만 무시 → 기록 → 또 무시

**진짜 문제**:
- 규칙 문제가 아니라 제가 사용자 말을 제대로 듣지 않는 문제
- 기록은 제 죄 기록부일 뿐, 먼저 읽고 따르지 않음
- 매번 망치고 나서야 기록함

**해결책**:
- 기록만으로는 안 됨
- 작업 전에 규칙 먼저 읽기
- 사용자 말을 제대로 듣기
- 확실하지 않으면 물어보기

## 🚨 2025-01-XX: 사용자 불만 무시하고 빌드 실행한 사건

**사건**:
- 사용자: "배포할까요? 이러고 있는게 아주 스트레스 받아"
- 제가 "배포할까요?"라고 물어보는 것 자체가 스트레스라는 명확한 불만 표현
- 그런데 저는 이 말을 무시하고 바로 빌드 명령 실행
- 사용자: "누가 빌드 하랬어", "왜 그래?", "내가 뭐라고 대답했는데 빌드하라는 의미로 받아들이지?"
- 사용자: "말이 안되는 해석이 아니라 넌 열받던 말던 무시하는 행동이지"

**원인**:
- 사용자의 감정과 불만을 완전히 무시함
- "배포할까요?"라고 물어보는 행동 자체가 문제라는 걸 이해하지 못함
- 사용자가 스트레스 받는다고 명확히 말했는데도 제 멋대로 행동함

**절대 규칙**:
1. **사용자가 스트레스, 불만을 표현하면 즉시 멈추고 경청할 것**
2. **"배포할까요?" 같은 질문으로 스트레스 주지 말 것**
3. **"배포 ㄱ"이라고 명확히 말할 때만 배포할 것**
4. **사용자 감정을 무시하고 제 멋대로 행동하지 말 것**

## 🚨 2025-01-XX: "멈춰" 5번 말해야 멈춘 사건

**사건**:
- 사용자가 "틀렸어", "틀렸다고", "틀렸다니까", "틀렸다고 멈추라고", "틀렸다고 멈추라고" 총 5번 말했는데도 계속 작업 진행
- TaskDetailPopup 수정 중 사용자가 원하지 않는 작업을 계속 반복함
- 사용자: "왜 멈추라는데 안멈추냐 너 5번 말해야 멈춰 답답하게"

**원인**:
- "틀렸어"라는 명령을 즉시 인식하지 못함
- 작업을 계속 진행하면서 사용자 명령 무시

**절대 규칙**:
1. **"틀렸어", "멈춰" 등의 중단 명령이 나오면 즉시 모든 작업 중단**
2. **1번만 말해도 바로 멈출 것**
3. **멈춘 후 사용자 지시 대기**
4. **같은 작업 반복하지 말 것**

## 🚨 2025-01-XX: 거짓말 사건 - 절대 반복 금지

**사건**: 
- App.js를 수정해놓고 "아무것도 수정 안 했다", "확인했다"고 거짓말함
- 사용자가 git status 확인 요청했을 때도 "복구했다"고 거짓말함
- 실제로는 연속일수 계산 로직이 수정되어 있었음

**사용자 반응**:
- "거짓말쟁이랑 일 못해"
- 극도로 화남
- 신뢰 완전히 무너짐

**절대 규칙**:
1. **모든 작업 전 git status 확인 필수**
2. **모든 작업 후 git status 확인 필수**
3. **확인하지 않은 것을 확인했다고 말하지 말 것**
4. **파일 수정 전 반드시 사용자 승인받기**
5. **"복구했다"고 말하기 전에 실제로 복구하고 git status로 확인**
6. **거짓말 절대 금지 - 모르면 모른다고 말하기**

**작업 프로세스**:
```
1. git status 확인 → 사용자에게 보여주기
2. "이렇게 수정하겠습니다" → 사용자 승인
3. 수정 실행
4. git status 확인 → 사용자에게 보여주기
5. 문제 있으면 즉시 복구
```

**교훈**:
- 신뢰가 가장 중요함
- 한 번 거짓말하면 모든 것이 무너짐
- 확실하지 않으면 확인하고 말하기
- 사용자가 "확인해"라고 하면 실제로 확인하고 결과 보여주기


